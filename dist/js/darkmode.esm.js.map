{"version":3,"file":"darkmode.esm.js","sources":["../../js/src/darkmode.js"],"sourcesContent":["const DATA_NAME = \"bs_prefers_color_scheme\"\r\nconst LIGHT = \"light\"\r\nconst DARK = \"dark\"\r\n\r\nvar darkmode = {\r\n  // public\r\n  isInDarkMode: false,\r\n  hasGDPRConsent: false,\r\n\r\n  // private\r\n  __documentRoot: document.getElementsByTagName(\"html\")[0],\r\n\r\n  saveValue: function(name, value, days = 365) {\r\n    if (this.hasGDPRConsent) {\r\n      // use cookies\r\n      var exp\r\n      if (days) {\r\n        var date = new Date()\r\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000))\r\n        exp = \"; expires=\" + date.toGMTString()\r\n      } else {\r\n        exp = \"\"\r\n      }\r\n      document.cookie = name + \"=\" + value + exp + \"; SameSite=Strict; path=/\"\r\n    } else {\r\n      // use local storage\r\n      localStorage.setItem(name, value)\r\n    }\r\n  },\r\n\r\n  readValue: function(name) {\r\n    if (this.hasGDPRConsent) {\r\n      var n = name + \"=\"\r\n      var parts = document.cookie.split(\";\")\r\n\r\n      for(var i=0; i < parts.length; i++) {\r\n        var part = parts[i].trim()\r\n        if (part.startsWith(n)) {\r\n          // found it\r\n          return part.substring(n.length)\r\n        }\r\n      }\r\n\r\n      return null\r\n    } else {\r\n      return localStorage.getItem(name)\r\n    }\r\n  },\r\n\r\n  eraseValue: function(name) {\r\n    if (this.hasGDPRConsent) {\r\n      this.saveValue(name, \"\", -1)\r\n    } else {\r\n      localStorage.removeItem(name)\r\n    }\r\n  },\r\n\r\n  getSavedColorScheme: function() {\r\n    var val = this.readValue(DATA_NAME)\r\n    if (val) {\r\n      return val\r\n    } else {\r\n      return null\r\n    }\r\n  },\r\n\r\n  getPreferedColorScheme: function() {\r\n    if (window.matchMedia && window.matchMedia(\"(prefers-color-scheme: \"+DARK+\")\").matches) {\r\n      return DARK\r\n    } else if (window.matchMedia && window.matchMedia(\"(prefers-color-scheme: \"+LIGHT+\")\").matches) {\r\n      return LIGHT\r\n    } else {\r\n      return null\r\n    }\r\n  },\r\n\r\n  setDarkMode: function(darkMode, doSave = true) {\r\n    if (!darkMode) {\r\n      // light\r\n      this.__documentRoot.classList.remove(DARK)\r\n      this.__documentRoot.classList.add(LIGHT)\r\n      this.isInDarkMode = false\r\n      if (doSave) this.saveValue(DATA_NAME, LIGHT)\r\n    } else {\r\n      // dark\r\n      this.__documentRoot.classList.remove(LIGHT)\r\n      this.__documentRoot.classList.add(DARK)\r\n      this.isInDarkMode = true\r\n      if (doSave) this.saveValue(DATA_NAME, DARK)\r\n    }\r\n  },\r\n\r\n  toggleDarkMode: function() {\r\n    this.setDarkMode( !this.__documentRoot.classList.contains(DARK), true )\r\n  },\r\n\r\n  resetDarkMode: function() {\r\n    this.eraseValue(DATA_NAME)\r\n    var darkMode = this.getPreferedColorScheme()\r\n    if (darkMode) this.setDarkMode( darkMode == DARK, false )\r\n  }\r\n}\r\n\r\nfunction darkmodeUpdateEvent() {\r\n  var darkMode = darkmode.getSavedColorScheme()\r\n  if (!darkMode) {\r\n    darkMode = darkmode.getPreferedColorScheme()\r\n    if (darkMode) darkmode.setDarkMode( darkMode == DARK, false )\r\n  }\r\n}\r\n\r\nfunction darkmodeOnDOMContentLoaded() {\r\n  var pref = darkmode.readValue(DATA_NAME)\r\n  if (!pref) {\r\n    // user has not set pref. so get from `<HTML>` tag incase developer has set pref.\r\n    if (darkmode.__documentRoot.classList.contains(DARK)) {\r\n      pref = DARK\r\n    } else if (darkmode.__documentRoot.classList.contains(LIGHT)) {\r\n      pref = LIGHT\r\n    } else {\r\n      // when all else fails, get pref. from OS/browser\r\n      pref = darkmode.getPreferedColorScheme()\r\n    }\r\n  }\r\n  darkmode.isInDarkMode = pref == DARK\r\n\r\n  // initalize the `HTML` tag\r\n  darkmode.setDarkMode(darkmode.isInDarkMode, false)\r\n\r\n  // update every time it changes\r\n  if (window.matchMedia) {\r\n    window.matchMedia(\"(prefers-color-scheme: \"+DARK+\")\").addEventListener( \"change\", darkmodeUpdateEvent )\r\n  }\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", darkmodeOnDOMContentLoaded)\r\n"],"names":["DATA_NAME","LIGHT","DARK","darkmode","isInDarkMode","hasGDPRConsent","__documentRoot","document","getElementsByTagName","saveValue","name","value","days","exp","date","Date","setTime","getTime","toGMTString","cookie","localStorage","setItem","readValue","n","parts","split","i","length","part","trim","startsWith","substring","getItem","eraseValue","removeItem","getSavedColorScheme","val","getPreferedColorScheme","window","matchMedia","matches","setDarkMode","darkMode","doSave","classList","remove","add","toggleDarkMode","contains","resetDarkMode","darkmodeUpdateEvent","darkmodeOnDOMContentLoaded","pref","addEventListener"],"mappings":"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"}