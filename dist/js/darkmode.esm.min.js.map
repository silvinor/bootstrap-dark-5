{"version":3,"file":"darkmode.esm.min.js","sources":["../../js/src/darkmode.js"],"sourcesContent":["const DATA_NAME = \"bs_prefers_color_scheme\"\r\nconst LIGHT = \"light\"\r\nconst DARK = \"dark\"\r\n\r\nvar darkmode = {\r\n  // public\r\n  isInDarkMode: false,\r\n  hasGDPRConsent: false,\r\n\r\n  // private\r\n  __documentRoot: document.getElementsByTagName(\"html\")[0],\r\n\r\n  saveValue: function(name, value, days = 365) {\r\n    if (this.hasGDPRConsent) {\r\n      // use cookies\r\n      var exp\r\n      if (days) {\r\n        var date = new Date()\r\n        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000))\r\n        exp = \"; expires=\" + date.toGMTString()\r\n      } else {\r\n        exp = \"\"\r\n      }\r\n      document.cookie = name + \"=\" + value + exp + \"; SameSite=Strict; path=/\"\r\n    } else {\r\n      // use local storage\r\n      localStorage.setItem(name, value)\r\n    }\r\n  },\r\n\r\n  readValue: function(name) {\r\n    if (this.hasGDPRConsent) {\r\n      var n = name + \"=\"\r\n      var parts = document.cookie.split(\";\")\r\n\r\n      for(var i=0; i < parts.length; i++) {\r\n        var part = parts[i].trim()\r\n        if (part.startsWith(n)) {\r\n          // found it\r\n          return part.substring(n.length)\r\n        }\r\n      }\r\n\r\n      return null\r\n    } else {\r\n      return localStorage.getItem(name)\r\n    }\r\n  },\r\n\r\n  eraseValue: function(name) {\r\n    if (this.hasGDPRConsent) {\r\n      this.saveValue(name, \"\", -1)\r\n    } else {\r\n      localStorage.removeItem(name)\r\n    }\r\n  },\r\n\r\n  getSavedColorScheme: function() {\r\n    var val = this.readValue(DATA_NAME)\r\n    if (val) {\r\n      return val\r\n    } else {\r\n      return null\r\n    }\r\n  },\r\n\r\n  getPreferedColorScheme: function() {\r\n    if (window.matchMedia && window.matchMedia(\"(prefers-color-scheme: \"+DARK+\")\").matches) {\r\n      return DARK\r\n    } else if (window.matchMedia && window.matchMedia(\"(prefers-color-scheme: \"+LIGHT+\")\").matches) {\r\n      return LIGHT\r\n    } else {\r\n      return null\r\n    }\r\n  },\r\n\r\n  setDarkMode: function(darkMode, doSave = true) {\r\n    if (!darkMode) {\r\n      // light\r\n      this.__documentRoot.classList.remove(DARK)\r\n      this.__documentRoot.classList.add(LIGHT)\r\n      this.isInDarkMode = false\r\n      if (doSave) this.saveValue(DATA_NAME, LIGHT)\r\n    } else {\r\n      // dark\r\n      this.__documentRoot.classList.remove(LIGHT)\r\n      this.__documentRoot.classList.add(DARK)\r\n      this.isInDarkMode = true\r\n      if (doSave) this.saveValue(DATA_NAME, DARK)\r\n    }\r\n  },\r\n\r\n  toggleDarkMode: function() {\r\n    this.setDarkMode( !this.__documentRoot.classList.contains(DARK), true )\r\n  },\r\n\r\n  resetDarkMode: function() {\r\n    this.eraseValue(DATA_NAME)\r\n    var darkMode = this.getPreferedColorScheme()\r\n    if (darkMode) this.setDarkMode( darkMode == DARK, false )\r\n  }\r\n}\r\n\r\nfunction darkmodeUpdateEvent() {\r\n  var darkMode = darkmode.getSavedColorScheme()\r\n  if (!darkMode) {\r\n    darkMode = darkmode.getPreferedColorScheme()\r\n    if (darkMode) darkmode.setDarkMode( darkMode == DARK, false )\r\n  }\r\n}\r\n\r\nfunction darkmodeOnDOMContentLoaded() {\r\n  var pref = darkmode.readValue(DATA_NAME)\r\n  if (!pref) {\r\n    // user has not set pref. so get from `<HTML>` tag incase developer has set pref.\r\n    if (darkmode.__documentRoot.classList.contains(DARK)) {\r\n      pref = DARK\r\n    } else if (darkmode.__documentRoot.classList.contains(LIGHT)) {\r\n      pref = LIGHT\r\n    } else {\r\n      // when all else fails, get pref. from OS/browser\r\n      pref = darkmode.getPreferedColorScheme()\r\n    }\r\n  }\r\n  darkmode.isInDarkMode = pref == DARK\r\n\r\n  // initalize the `HTML` tag\r\n  darkmode.setDarkMode(darkmode.isInDarkMode, false)\r\n\r\n  // update every time it changes\r\n  if (window.matchMedia) {\r\n    window.matchMedia(\"(prefers-color-scheme: \"+DARK+\")\").addEventListener( \"change\", darkmodeUpdateEvent )\r\n  }\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", darkmodeOnDOMContentLoaded)\r\n"],"names":["DATA_NAME","DARK","darkmode","isInDarkMode","hasGDPRConsent","__documentRoot","document","getElementsByTagName","saveValue","name","value","days","this","exp","date","Date","setTime","getTime","toGMTString","cookie","localStorage","setItem","readValue","n","parts","split","i","length","part","trim","startsWith","substring","getItem","eraseValue","removeItem","getSavedColorScheme","val","getPreferedColorScheme","window","matchMedia","matches","setDarkMode","darkMode","doSave","classList","remove","add","toggleDarkMode","contains","resetDarkMode","darkmodeUpdateEvent","addEventListener","pref"],"mappings":";;;;;AAAA,MAAMA,EAAY,0BAEZC,EAAO,OAEb,IAAIC,EAAW,CAEbC,cAAc,EACdC,gBAAgB,EAGhBC,eAAgBC,SAASC,qBAAqB,QAAQ,GAEtDC,UAAW,SAASC,EAAMC,EAAOC,EAAO,QAClCC,KAAKR,eAAgB,KAEnBS,KACAF,EAAM,KACJG,EAAO,IAAIC,KACfD,EAAKE,QAAQF,EAAKG,UAAoB,GAAPN,EAAY,GAAK,GAAK,KACrDE,EAAM,aAAeC,EAAKI,mBAE1BL,EAAM,GAERP,SAASa,OAASV,EAAO,IAAMC,EAAQG,EAAM,iCAG7CO,aAAaC,QAAQZ,EAAMC,IAI/BY,UAAW,SAASb,MACdG,KAAKR,eAAgB,SACnBmB,EAAId,EAAO,IACXe,EAAQlB,SAASa,OAAOM,MAAM,KAE1BC,EAAE,EAAGA,EAAIF,EAAMG,OAAQD,IAAK,KAC9BE,EAAOJ,EAAME,GAAGG,UAChBD,EAAKE,WAAWP,UAEXK,EAAKG,UAAUR,EAAEI,eAIrB,YAEAP,aAAaY,QAAQvB,IAIhCwB,WAAY,SAASxB,GACfG,KAAKR,oBACFI,UAAUC,EAAM,IAAK,GAE1BW,aAAac,WAAWzB,IAI5B0B,oBAAqB,eACfC,EAAMxB,KAAKU,UAAUtB,UACrBoC,GAGK,MAIXC,uBAAwB,kBAClBC,OAAOC,YAAcD,OAAOC,WAAW,gCAAoCC,QACtEvC,EACEqC,OAAOC,YAAcD,OAAOC,WAAW,iCAAqCC,QApE7E,QAuED,MAIXC,YAAa,SAASC,EAAUC,GAAS,GAClCD,QAQErC,eAAeuC,UAAUC,OApFtB,cAqFHxC,eAAeuC,UAAUE,IAAI7C,QAC7BE,cAAe,EAChBwC,GAAQ/B,KAAKJ,UAAUR,EAAWC,UATjCI,eAAeuC,UAAUC,OAAO5C,QAChCI,eAAeuC,UAAUE,IA/EtB,cAgFH3C,cAAe,EAChBwC,GAAQ/B,KAAKJ,UAAUR,EAjFnB,WA2FZ+C,eAAgB,gBACTN,aAAc7B,KAAKP,eAAeuC,UAAUI,SAAS/C,IAAO,IAGnEgD,cAAe,gBACRhB,WAAWjC,OACZ0C,EAAW9B,KAAKyB,yBAChBK,GAAU9B,KAAK6B,YAAaC,GAAYzC,GAAM,KAItD,SAASiD,QACHR,EAAWxC,EAASiC,sBACnBO,IACHA,EAAWxC,EAASmC,2BACNnC,EAASuC,YAAaC,GAAYzC,GAAM,GA4B1DK,SAAS6C,iBAAiB,oBAxB1B,eACMC,EAAOlD,EAASoB,UAAUtB,GACzBoD,IAGDA,EADElD,EAASG,eAAeuC,UAAUI,SAAS/C,GACtCA,EACEC,EAASG,eAAeuC,UAAUI,SApHnC,SAAA,QAwHD9C,EAASmC,0BAGpBnC,EAASC,aAAeiD,GAAQnD,EAGhCC,EAASuC,YAAYvC,EAASC,cAAc,GAGxCmC,OAAOC,YACTD,OAAOC,WAAW,gCAAoCY,iBAAkB,SAAUD"}